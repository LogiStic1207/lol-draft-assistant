<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hard Fearless Draft OS</title>
  <meta name="description" content="스크림 데이터 기반 Hard Fearless BO3/BO5 밴픽 운영 시스템" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- Custom Titlebar (Electron frameless) -->
  <div class="custom-titlebar" id="titlebar">
    <div class="titlebar-drag">
      <div class="titlebar-icon">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
        </svg>
      </div>
      <span class="titlebar-title">Hard Fearless Draft OS</span>
    </div>
    <div class="titlebar-controls">
      <button class="titlebar-btn" id="btn-settings" title="설정">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3" />
          <path
            d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z" />
        </svg>
      </button>
      <button class="titlebar-btn minimize" id="btn-win-minimize" title="최소화">
        <svg width="12" height="12" viewBox="0 0 12 12">
          <rect y="5" width="12" height="1.5" fill="currentColor" />
        </svg>
      </button>
      <button class="titlebar-btn maximize" id="btn-win-maximize" title="최대화">
        <svg width="12" height="12" viewBox="0 0 12 12">
          <rect x="1" y="1" width="10" height="10" stroke="currentColor" stroke-width="1.5" fill="none" />
        </svg>
      </button>
      <button class="titlebar-btn close" id="btn-win-close" title="닫기">
        <svg width="12" height="12" viewBox="0 0 12 12">
          <line x1="1" y1="1" x2="11" y2="11" stroke="currentColor" stroke-width="1.5" />
          <line x1="11" y1="1" x2="1" y2="11" stroke="currentColor" stroke-width="1.5" />
        </svg>
      </button>
    </div>
  </div>

  <!-- App Body: Sidebar + Main side by side -->
  <div class="app-body">

    <!-- Sidebar Navigation -->
    <nav class="sidebar" id="sidebar">
      <div class="sidebar-logo">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
        </svg>
        <span class="logo-text">DRAFT OS</span>
      </div>
      <div class="nav-items">
        <div class="nav-item active" data-view="draft">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7" />
            <rect x="14" y="3" width="7" height="7" />
            <rect x="3" y="14" width="7" height="7" />
            <rect x="14" y="14" width="7" height="7" />
          </svg>
          <span>Draft Room</span>
        </div>
        <div class="nav-item" data-view="team">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
            <circle cx="9" cy="7" r="4" />
            <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
            <path d="M16 3.13a4 4 0 0 1 0 7.75" />
          </svg>
          <span>Team DNA</span>
        </div>
        <div class="nav-item" data-view="scouting">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8" />
            <line x1="21" y1="21" x2="16.65" y2="16.65" />
          </svg>
          <span>Scouting</span>
        </div>
        <div class="nav-item" data-view="scrim-log">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
            <polyline points="14 2 14 8 20 8" />
            <line x1="16" y1="13" x2="8" y2="13" />
            <line x1="16" y1="17" x2="8" y2="17" />
            <polyline points="10 9 9 9 8 9" />
          </svg>
          <span>Scrim/Match Log</span>
        </div>
      </div>
      <div class="sidebar-footer">
        <div class="rule-badge">HARD FEARLESS</div>
        <div class="rule-desc">양 팀 글로벌 잠금</div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <section class="view active" id="view-draft"></section>
      <section class="view" id="view-team"></section>
      <section class="view" id="view-scouting"></section>
      <section class="view" id="view-scrim-log"></section>
    </main>

  </div><!-- .app-body -->

  <!-- ========== GLOBAL MODALS (accessible from all pages) ========== -->

  <!-- Series Complete Modal -->
  <div class="modal-overlay hidden" id="modal-series-complete">
    <div class="modal series-complete-modal">
      <div class="series-complete-icon">🏆</div>
      <h3>시리즈 완료!</h3>
      <p id="series-complete-summary" class="series-complete-summary"></p>
      <div class="modal-actions">
        <button class="btn btn-accent" id="modal-series-ok">확인</button>
      </div>
    </div>
  </div>

  <!-- Meta Modal -->
  <div class="modal-overlay hidden" id="modal-meta">
    <div class="modal modal-wide">
      <h3>🔧 패치 메타 정보</h3>
      <div class="meta-modal-content" id="meta-modal-content">
        <p>패치 데이터를 불러오는 중...</p>
      </div>
      <div class="modal-actions">
        <button class="btn" id="modal-meta-close">닫기</button>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="modal-overlay hidden" id="modal-settings">
    <div class="modal modal-wide">
      <h3>⚙️ 설정</h3>
      <div class="settings-content">
        <div class="settings-section">
          <h4>데이터 관리</h4>
          <button class="btn btn-danger" id="btn-reset-data">🗑️ 전체 데이터 초기화</button>
          <p class="settings-hint">모든 팀 정보, 선수 데이터, 경기 기록이 삭제됩니다.</p>
        </div>
        <div class="settings-section">
          <h4>버그 리포트</h4>
          <div class="form-group">
            <label>제목</label>
            <input type="text" id="bug-title" placeholder="버그 제목" />
          </div>
          <div class="form-group">
            <label>내용</label>
            <textarea id="bug-description" rows="4" placeholder="버그 상세 설명..."></textarea>
          </div>
          <button class="btn btn-accent" id="btn-submit-bug">📨 버그 제출</button>
          <p id="bug-submit-status" class="settings-hint"></p>
        </div>
      </div>
      <div class="modal-actions">
        <button class="btn" id="modal-settings-close">닫기</button>
      </div>
    </div>
  </div>

  <!-- Lane Assignment Modal -->
  <div class="modal-overlay hidden" id="modal-lane-assign">
    <div class="modal modal-wide">
      <h3>🎯 라인 배정</h3>
      <p class="settings-hint" style="margin-bottom:12px">각 챔피언의 실제 라인을 선택하세요</p>
      <div id="lane-assign-list"></div>
      <div class="modal-actions">
        <button class="btn btn-accent" id="btn-lane-confirm">확인</button>
      </div>
    </div>
  </div>

  <!-- Scripts (order matters) -->
  <script src="js/data.js"></script>
  <script src="js/version-checker.js"></script>
  <script src="js/meta-analyzer.js"></script>
  <script src="js/store.js"></script>
  <script src="js/router.js"></script>
  <script src="js/draft-engine.js"></script>
  <script src="js/analysis.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/team-ui.js"></script>
  <script src="js/scouting-ui.js"></script>
  <script src="js/scrim-ui.js"></script>
  <script src="js/app.js"></script>
  <script>
    // Electron titlebar buttons
    if (window.electronAPI) {
      document.getElementById('btn-win-minimize')?.addEventListener('click', () => window.electronAPI.minimize());
      document.getElementById('btn-win-maximize')?.addEventListener('click', () => window.electronAPI.maximize());
      document.getElementById('btn-win-close')?.addEventListener('click', () => window.electronAPI.close());
    } else {
      document.querySelectorAll('.titlebar-btn.minimize, .titlebar-btn.maximize, .titlebar-btn.close').forEach(b => b.style.display = 'none');
    }

    // Global settings button
    document.getElementById('btn-settings')?.addEventListener('click', () => {
      document.getElementById('modal-settings')?.classList.remove('hidden');
    });
    document.getElementById('modal-settings-close')?.addEventListener('click', () => {
      document.getElementById('modal-settings')?.classList.add('hidden');
    });
    document.getElementById('btn-reset-data')?.addEventListener('click', () => {
      if (!confirm('⚠️ 모든 데이터가 삭제됩니다. 계속하시겠습니까?')) return;
      localStorage.clear();
      alert('데이터가 초기화되었습니다.');
      location.reload();
    });
    document.getElementById('btn-submit-bug')?.addEventListener('click', () => {
      const title = document.getElementById('bug-title')?.value || '';
      const desc = document.getElementById('bug-description')?.value || '';
      if (!title || !desc) {
        document.getElementById('bug-submit-status').textContent = '⚠️ 제목과 내용을 모두 입력해주세요.';
        return;
      }
      const subject = encodeURIComponent(`[Draft OS Bug] ${title}`);
      const body = encodeURIComponent(`${desc}\n\n---\nApp: Draft OS\nDate: ${new Date().toISOString()}`);
      window.open(`mailto:tinyrexx1207@gmail.com?subject=${subject}&body=${body}`);
      document.getElementById('bug-submit-status').textContent = '✅ 제출 완료!';
      document.getElementById('bug-title').value = '';
      document.getElementById('bug-description').value = '';
    });

    // Global meta modal close
    document.getElementById('modal-meta-close')?.addEventListener('click', () => {
      document.getElementById('modal-meta')?.classList.add('hidden');
    });
  </script>
</body>

</html>